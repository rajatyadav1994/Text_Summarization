[2020-04-12 17:04:53,269 INFO] Loading checkpoint from ../models/bert_transformer/model_step_1000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 17:05:12,696 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 17:05:12,699 INFO] * number of parameters: 120512513
[2020-04-12 17:08:50,356 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 17:12:11,029 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 17:15:16,583 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 17:18:37,296 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 17:21:50,630 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 17:25:00,555 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 17:27:12,802 INFO] Validation xent: 6.39184 at step 1000
[2020-04-12 17:27:12,843 INFO] Loading checkpoint from ../models/bert_transformer/model_step_2000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 17:27:31,318 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 17:27:31,320 INFO] * number of parameters: 120512513
[2020-04-12 17:30:15,408 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 17:33:21,947 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 17:36:31,020 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 17:39:39,826 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 17:42:48,416 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 17:45:52,340 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 17:47:58,847 INFO] Validation xent: 6.03152 at step 2000
[2020-04-12 17:47:58,891 INFO] Loading checkpoint from ../models/bert_transformer/model_step_3000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 17:48:17,653 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 17:48:17,655 INFO] * number of parameters: 120512513
[2020-04-12 17:51:09,455 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 17:54:21,846 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 17:57:29,939 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 18:00:39,268 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 18:03:42,867 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 18:07:00,181 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 18:08:59,832 INFO] Validation xent: 5.92915 at step 3000
[2020-04-12 18:08:59,842 INFO] Loading checkpoint from ../models/bert_transformer/model_step_4000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 18:09:17,527 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 18:09:17,529 INFO] * number of parameters: 120512513
[2020-04-12 18:12:00,777 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 18:14:58,084 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 18:17:55,868 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 18:20:55,255 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 18:23:52,921 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 18:26:54,189 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 18:28:53,698 INFO] Validation xent: 5.86833 at step 4000
[2020-04-12 18:28:53,739 INFO] Loading checkpoint from ../models/bert_transformer/model_step_5000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 18:29:11,782 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 18:29:11,785 INFO] * number of parameters: 120512513
[2020-04-12 18:31:53,527 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 18:34:53,998 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 18:37:50,475 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 18:40:45,090 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 18:43:42,934 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 18:46:39,449 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 18:48:40,843 INFO] Validation xent: 5.91805 at step 5000
[2020-04-12 18:48:40,853 INFO] Loading checkpoint from ../models/bert_transformer/model_step_6000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 18:48:58,555 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 18:48:58,557 INFO] * number of parameters: 120512513
[2020-04-12 18:51:39,322 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 18:54:41,599 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 18:57:40,818 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 19:00:40,850 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 19:03:40,915 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 19:06:42,277 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 19:08:42,216 INFO] Validation xent: 5.98793 at step 6000
[2020-04-12 19:08:42,219 INFO] Loading checkpoint from ../models/bert_transformer/model_step_7000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 19:09:01,353 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 19:09:01,355 INFO] * number of parameters: 120512513
[2020-04-12 19:11:41,962 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 19:14:40,205 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 19:17:39,733 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 19:20:38,228 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 19:23:35,868 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 19:26:35,183 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 19:28:34,229 INFO] Validation xent: 5.79024 at step 7000
[2020-04-12 19:28:34,230 INFO] Loading checkpoint from ../models/bert_transformer/model_step_8000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 19:28:52,758 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 19:28:52,760 INFO] * number of parameters: 120512513
[2020-04-12 19:31:34,441 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 19:34:34,214 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 19:37:30,866 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 19:40:30,923 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 19:43:31,893 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 19:46:30,970 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 19:48:32,152 INFO] Validation xent: 5.78032 at step 8000
[2020-04-12 19:48:32,154 INFO] Loading checkpoint from ../models/bert_transformer/model_step_9000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 19:48:50,867 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 19:48:50,869 INFO] * number of parameters: 120512513
[2020-04-12 19:51:33,513 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 19:54:36,733 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 19:57:33,636 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 20:00:36,939 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 20:03:38,361 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 20:06:40,048 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 20:08:42,670 INFO] Validation xent: 5.79051 at step 9000
[2020-04-12 20:08:42,673 INFO] Loading checkpoint from ../models/bert_transformer/model_step_10000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 20:09:01,516 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 20:09:01,518 INFO] * number of parameters: 120512513
[2020-04-12 20:11:43,963 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-12 20:14:47,135 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-12 20:17:49,924 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-12 20:20:54,651 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-12 20:23:57,619 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-12 20:27:04,912 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-12 20:29:11,314 INFO] Validation xent: 5.70927 at step 10000
[2020-04-12 20:29:11,316 INFO] PPL [(5.709267562691557, '../models/bert_transformer/model_step_10000.pt'), (5.780321921568815, '../models/bert_transformer/model_step_8000.pt'), (5.790241924373501, '../models/bert_transformer/model_step_7000.pt')]
[2020-04-12 20:29:11,316 INFO] Loading checkpoint from ../models/bert_transformer/model_step_10000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 20:29:13,124 INFO] Loading test dataset from ../bert_data/cnndm.test.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 20:29:13,126 INFO] * number of parameters: 120512513
[2020-04-12 20:32:12,872 INFO] Loading test dataset from ../bert_data/cnndm.test.1.bert.pt, number of examples: 2001
[2020-04-12 20:35:15,709 INFO] Loading test dataset from ../bert_data/cnndm.test.2.bert.pt, number of examples: 2001
[2020-04-12 20:38:22,438 INFO] Loading test dataset from ../bert_data/cnndm.test.3.bert.pt, number of examples: 2001
[2020-04-12 20:41:26,023 INFO] Loading test dataset from ../bert_data/cnndm.test.4.bert.pt, number of examples: 2000
[2020-04-12 20:44:29,656 INFO] Loading test dataset from ../bert_data/cnndm.test.5.bert.pt, number of examples: 1485
11489
11489
2020-04-12 20:46:49,435 [MainThread  ] [INFO ]  Writing summaries.
[2020-04-12 20:46:49,435 INFO] Writing summaries.
2020-04-12 20:46:49,436 [MainThread  ] [INFO ]  Processing summaries. Saving system files to ../temp/tmp3ie5f8sr/system and model files to ../temp/tmp3ie5f8sr/model.
[2020-04-12 20:46:49,436 INFO] Processing summaries. Saving system files to ../temp/tmp3ie5f8sr/system and model files to ../temp/tmp3ie5f8sr/model.
2020-04-12 20:46:49,436 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-12-20-46-48/candidate/.
[2020-04-12 20:46:49,436 INFO] Processing files in ../temp/rouge-tmp-2020-04-12-20-46-48/candidate/.
2020-04-12 20:46:50,230 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmp3ie5f8sr/system.
[2020-04-12 20:46:50,230 INFO] Saved processed files to ../temp/tmp3ie5f8sr/system.
2020-04-12 20:46:50,230 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-12-20-46-48/reference/.
[2020-04-12 20:46:50,230 INFO] Processing files in ../temp/rouge-tmp-2020-04-12-20-46-48/reference/.
2020-04-12 20:46:51,040 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmp3ie5f8sr/model.
[2020-04-12 20:46:51,040 INFO] Saved processed files to ../temp/tmp3ie5f8sr/model.
2020-04-12 20:46:51,116 [MainThread  ] [INFO ]  Written ROUGE configuration to ../temp/tmprqecuzvq/rouge_conf.xml
[2020-04-12 20:46:51,116 INFO] Written ROUGE configuration to ../temp/tmprqecuzvq/rouge_conf.xml
2020-04-12 20:46:51,116 [MainThread  ] [INFO ]  Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmprqecuzvq/rouge_conf.xml
[2020-04-12 20:46:51,116 INFO] Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmprqecuzvq/rouge_conf.xml
---------------------------------------------
1 ROUGE-1 Average_R: 0.52445 (95%-conf.int. 0.52185 - 0.52725)
1 ROUGE-1 Average_P: 0.36705 (95%-conf.int. 0.36476 - 0.36957)
1 ROUGE-1 Average_F: 0.41775 (95%-conf.int. 0.41558 - 0.41992)
---------------------------------------------
1 ROUGE-2 Average_R: 0.23888 (95%-conf.int. 0.23611 - 0.24151)
1 ROUGE-2 Average_P: 0.16756 (95%-conf.int. 0.16550 - 0.16971)
1 ROUGE-2 Average_F: 0.19030 (95%-conf.int. 0.18811 - 0.19255)
---------------------------------------------
1 ROUGE-L Average_R: 0.47947 (95%-conf.int. 0.47675 - 0.48222)
1 ROUGE-L Average_P: 0.33614 (95%-conf.int. 0.33395 - 0.33851)
1 ROUGE-L Average_F: 0.38230 (95%-conf.int. 0.38021 - 0.38447)

[2020-04-12 20:48:20,402 INFO] Rouges at step 10000 
>> ROUGE-F(1/2/3/l): 41.77/19.03/38.23
ROUGE-R(1/2/3/l): 52.45/23.89/47.95

[2020-04-12 20:48:20,403 INFO] Validation xent: 5.66017 at step 10000
[2020-04-12 20:48:20,407 INFO] Loading checkpoint from ../models/bert_transformer/model_step_8000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 20:48:22,372 INFO] Loading test dataset from ../bert_data/cnndm.test.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 20:48:22,374 INFO] * number of parameters: 120512513
[2020-04-12 20:50:06,390 INFO] Loading test dataset from ../bert_data/cnndm.test.1.bert.pt, number of examples: 2001
[2020-04-12 20:53:13,427 INFO] Loading test dataset from ../bert_data/cnndm.test.2.bert.pt, number of examples: 2001
[2020-04-12 20:56:16,469 INFO] Loading test dataset from ../bert_data/cnndm.test.3.bert.pt, number of examples: 2001
[2020-04-12 20:59:19,632 INFO] Loading test dataset from ../bert_data/cnndm.test.4.bert.pt, number of examples: 2000
[2020-04-12 21:02:22,951 INFO] Loading test dataset from ../bert_data/cnndm.test.5.bert.pt, number of examples: 1485
11489
11489
2020-04-12 21:04:41,737 [MainThread  ] [INFO ]  Writing summaries.
[2020-04-12 21:04:41,737 INFO] Writing summaries.
2020-04-12 21:04:41,737 [MainThread  ] [INFO ]  Processing summaries. Saving system files to ../temp/tmplp9j3cnk/system and model files to ../temp/tmplp9j3cnk/model.
[2020-04-12 21:04:41,737 INFO] Processing summaries. Saving system files to ../temp/tmplp9j3cnk/system and model files to ../temp/tmplp9j3cnk/model.
2020-04-12 21:04:41,737 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-12-21-04-41/candidate/.
[2020-04-12 21:04:41,737 INFO] Processing files in ../temp/rouge-tmp-2020-04-12-21-04-41/candidate/.
2020-04-12 21:04:42,529 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmplp9j3cnk/system.
[2020-04-12 21:04:42,529 INFO] Saved processed files to ../temp/tmplp9j3cnk/system.
2020-04-12 21:04:42,529 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-12-21-04-41/reference/.
[2020-04-12 21:04:42,529 INFO] Processing files in ../temp/rouge-tmp-2020-04-12-21-04-41/reference/.
2020-04-12 21:04:43,322 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmplp9j3cnk/model.
[2020-04-12 21:04:43,322 INFO] Saved processed files to ../temp/tmplp9j3cnk/model.
2020-04-12 21:04:43,405 [MainThread  ] [INFO ]  Written ROUGE configuration to ../temp/tmpjj5wp7yi/rouge_conf.xml
[2020-04-12 21:04:43,405 INFO] Written ROUGE configuration to ../temp/tmpjj5wp7yi/rouge_conf.xml
2020-04-12 21:04:43,405 [MainThread  ] [INFO ]  Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmpjj5wp7yi/rouge_conf.xml
[2020-04-12 21:04:43,405 INFO] Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmpjj5wp7yi/rouge_conf.xml
---------------------------------------------
1 ROUGE-1 Average_R: 0.52596 (95%-conf.int. 0.52332 - 0.52893)
1 ROUGE-1 Average_P: 0.36103 (95%-conf.int. 0.35867 - 0.36339)
1 ROUGE-1 Average_F: 0.41415 (95%-conf.int. 0.41204 - 0.41635)
---------------------------------------------
1 ROUGE-2 Average_R: 0.23754 (95%-conf.int. 0.23500 - 0.24032)
1 ROUGE-2 Average_P: 0.16307 (95%-conf.int. 0.16118 - 0.16509)
1 ROUGE-2 Average_F: 0.18678 (95%-conf.int. 0.18477 - 0.18892)
---------------------------------------------
1 ROUGE-L Average_R: 0.47986 (95%-conf.int. 0.47728 - 0.48269)
1 ROUGE-L Average_P: 0.32992 (95%-conf.int. 0.32762 - 0.33223)
1 ROUGE-L Average_F: 0.37822 (95%-conf.int. 0.37611 - 0.38046)

[2020-04-12 21:06:14,252 INFO] Rouges at step 8000 
>> ROUGE-F(1/2/3/l): 41.41/18.68/37.82
ROUGE-R(1/2/3/l): 52.60/23.75/47.99

[2020-04-12 21:06:14,252 INFO] Validation xent: 5.73619 at step 8000
[2020-04-12 21:06:14,256 INFO] Loading checkpoint from ../models/bert_transformer/model_step_7000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='transformer', ff_size=2048, gpu_ranks=[0], heads=8, hidden_size=128, inter_layers=2, log_file='../logs/test_bert_transformer', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_transformer/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_transformer', rnn_size=512, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-12 21:06:16,195 INFO] Loading test dataset from ../bert_data/cnndm.test.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-12 21:06:16,197 INFO] * number of parameters: 120512513
[2020-04-12 21:07:57,289 INFO] Loading test dataset from ../bert_data/cnndm.test.1.bert.pt, number of examples: 2001
[2020-04-12 21:10:52,941 INFO] Loading test dataset from ../bert_data/cnndm.test.2.bert.pt, number of examples: 2001
[2020-04-12 21:13:50,919 INFO] Loading test dataset from ../bert_data/cnndm.test.3.bert.pt, number of examples: 2001
[2020-04-12 21:16:55,227 INFO] Loading test dataset from ../bert_data/cnndm.test.4.bert.pt, number of examples: 2000
[2020-04-12 21:19:57,200 INFO] Loading test dataset from ../bert_data/cnndm.test.5.bert.pt, number of examples: 1485
11489
11489
2020-04-12 21:22:12,596 [MainThread  ] [INFO ]  Writing summaries.
[2020-04-12 21:22:12,596 INFO] Writing summaries.
2020-04-12 21:22:12,596 [MainThread  ] [INFO ]  Processing summaries. Saving system files to ../temp/tmpnrzgg4o7/system and model files to ../temp/tmpnrzgg4o7/model.
[2020-04-12 21:22:12,596 INFO] Processing summaries. Saving system files to ../temp/tmpnrzgg4o7/system and model files to ../temp/tmpnrzgg4o7/model.
2020-04-12 21:22:12,596 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-12-21-22-11/candidate/.
[2020-04-12 21:22:12,596 INFO] Processing files in ../temp/rouge-tmp-2020-04-12-21-22-11/candidate/.
2020-04-12 21:22:13,390 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmpnrzgg4o7/system.
[2020-04-12 21:22:13,390 INFO] Saved processed files to ../temp/tmpnrzgg4o7/system.
2020-04-12 21:22:13,390 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-12-21-22-11/reference/.
[2020-04-12 21:22:13,390 INFO] Processing files in ../temp/rouge-tmp-2020-04-12-21-22-11/reference/.
2020-04-12 21:22:14,198 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmpnrzgg4o7/model.
[2020-04-12 21:22:14,198 INFO] Saved processed files to ../temp/tmpnrzgg4o7/model.
2020-04-12 21:22:14,439 [MainThread  ] [INFO ]  Written ROUGE configuration to ../temp/tmpfmy7gd79/rouge_conf.xml
[2020-04-12 21:22:14,439 INFO] Written ROUGE configuration to ../temp/tmpfmy7gd79/rouge_conf.xml
2020-04-12 21:22:14,439 [MainThread  ] [INFO ]  Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmpfmy7gd79/rouge_conf.xml
[2020-04-12 21:22:14,439 INFO] Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmpfmy7gd79/rouge_conf.xml
---------------------------------------------
1 ROUGE-1 Average_R: 0.52658 (95%-conf.int. 0.52404 - 0.52920)
1 ROUGE-1 Average_P: 0.36047 (95%-conf.int. 0.35817 - 0.36275)
1 ROUGE-1 Average_F: 0.41401 (95%-conf.int. 0.41197 - 0.41589)
---------------------------------------------
1 ROUGE-2 Average_R: 0.23726 (95%-conf.int. 0.23472 - 0.23992)
1 ROUGE-2 Average_P: 0.16229 (95%-conf.int. 0.16026 - 0.16416)
1 ROUGE-2 Average_F: 0.18623 (95%-conf.int. 0.18413 - 0.18837)
---------------------------------------------
1 ROUGE-L Average_R: 0.48028 (95%-conf.int. 0.47765 - 0.48304)
1 ROUGE-L Average_P: 0.32930 (95%-conf.int. 0.32711 - 0.33148)
1 ROUGE-L Average_F: 0.37797 (95%-conf.int. 0.37593 - 0.37990)

[2020-04-12 21:23:45,525 INFO] Rouges at step 7000 
>> ROUGE-F(1/2/3/l): 41.40/18.62/37.80
ROUGE-R(1/2/3/l): 52.66/23.73/48.03

