[2020-04-13 02:51:05,821 INFO] Loading checkpoint from ../models/bert_rnn/model_step_1000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 02:51:25,186 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 02:51:25,188 INFO] * number of parameters: 113041921
[2020-04-13 02:52:44,289 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 02:57:56,237 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 03:07:13,916 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 03:17:40,552 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 03:28:03,000 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 03:38:30,123 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 03:45:24,211 INFO] Validation xent: 6.53908 at step 1000
[2020-04-13 03:45:24,252 INFO] Loading checkpoint from ../models/bert_rnn/model_step_2000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 03:45:42,004 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 03:45:42,006 INFO] * number of parameters: 113041921
[2020-04-13 03:54:28,944 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 04:03:00,654 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 04:11:23,872 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 04:19:49,662 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 04:28:32,813 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 04:37:12,841 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 04:42:55,768 INFO] Validation xent: 6.06032 at step 2000
[2020-04-13 04:42:55,810 INFO] Loading checkpoint from ../models/bert_rnn/model_step_3000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 04:43:13,381 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 04:43:13,383 INFO] * number of parameters: 113041921
[2020-04-13 04:51:18,304 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 04:59:45,608 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 05:07:14,402 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 05:13:35,897 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 05:20:04,736 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 05:26:58,803 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 05:31:46,848 INFO] Validation xent: 5.96937 at step 3000
[2020-04-13 05:31:46,860 INFO] Loading checkpoint from ../models/bert_rnn/model_step_4000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 05:32:04,234 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 05:32:04,236 INFO] * number of parameters: 113041921
[2020-04-13 05:39:37,409 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 05:47:34,008 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 05:55:46,858 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 06:04:06,648 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 06:12:41,251 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 06:21:26,019 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 06:27:12,080 INFO] Validation xent: 5.90323 at step 4000
[2020-04-13 06:27:12,081 INFO] Loading checkpoint from ../models/bert_rnn/model_step_5000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 06:27:29,567 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 06:27:29,569 INFO] * number of parameters: 113041921
[2020-04-13 06:34:59,981 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 06:43:10,122 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 06:51:19,007 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 06:58:50,351 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 07:06:17,882 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 07:13:56,691 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 07:20:32,503 INFO] Validation xent: 5.85377 at step 5000
[2020-04-13 07:20:32,504 INFO] Loading checkpoint from ../models/bert_rnn/model_step_6000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 07:20:49,907 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 07:20:49,909 INFO] * number of parameters: 113041921
[2020-04-13 07:28:44,899 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 07:36:42,075 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 07:44:42,878 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 07:52:46,292 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 08:00:40,511 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 08:09:01,395 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 08:14:24,761 INFO] Validation xent: 5.76016 at step 6000
[2020-04-13 08:14:24,763 INFO] Loading checkpoint from ../models/bert_rnn/model_step_7000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 08:14:42,372 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 08:14:42,374 INFO] * number of parameters: 113041921
[2020-04-13 08:23:04,293 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 08:31:46,152 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 08:41:03,247 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 08:50:58,380 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 09:01:00,393 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 09:11:01,733 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 09:17:55,143 INFO] Validation xent: 5.74177 at step 7000
[2020-04-13 09:17:55,144 INFO] Loading checkpoint from ../models/bert_rnn/model_step_8000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 09:18:12,562 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 09:18:12,564 INFO] * number of parameters: 113041921
[2020-04-13 09:25:58,431 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 09:34:20,154 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 09:42:45,895 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 09:51:04,669 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 09:59:27,876 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 10:07:51,475 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 10:13:19,041 INFO] Validation xent: 5.79613 at step 8000
[2020-04-13 10:13:19,042 INFO] Loading checkpoint from ../models/bert_rnn/model_step_9000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 10:13:36,736 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 10:13:36,738 INFO] * number of parameters: 113041921
[2020-04-13 10:23:01,841 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 10:32:41,180 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 10:42:34,785 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 10:52:32,617 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 11:02:54,811 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 11:13:21,968 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 11:19:51,129 INFO] Validation xent: 5.8814 at step 9000
[2020-04-13 11:19:51,130 INFO] Loading checkpoint from ../models/bert_rnn/model_step_10000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 11:20:08,875 INFO] Loading valid dataset from ../bert_data/cnndm.valid.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 11:20:08,877 INFO] * number of parameters: 113041921
[2020-04-13 11:28:07,128 INFO] Loading valid dataset from ../bert_data/cnndm.valid.1.bert.pt, number of examples: 2001
[2020-04-13 11:36:47,858 INFO] Loading valid dataset from ../bert_data/cnndm.valid.2.bert.pt, number of examples: 2001
[2020-04-13 11:43:12,778 INFO] Loading valid dataset from ../bert_data/cnndm.valid.3.bert.pt, number of examples: 2000
[2020-04-13 11:46:09,671 INFO] Loading valid dataset from ../bert_data/cnndm.valid.4.bert.pt, number of examples: 2001
[2020-04-13 11:48:57,557 INFO] Loading valid dataset from ../bert_data/cnndm.valid.5.bert.pt, number of examples: 2001
[2020-04-13 11:51:44,640 INFO] Loading valid dataset from ../bert_data/cnndm.valid.6.bert.pt, number of examples: 1362
[2020-04-13 11:53:35,480 INFO] Validation xent: 5.70656 at step 10000
[2020-04-13 11:53:35,482 INFO] PPL [(5.706563973985097, '../models/bert_rnn/model_step_10000.pt'), (5.741770636092719, '../models/bert_rnn/model_step_7000.pt'), (5.76016224735363, '../models/bert_rnn/model_step_6000.pt')]
[2020-04-13 11:53:35,482 INFO] Loading checkpoint from ../models/bert_rnn/model_step_10000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 11:53:37,179 INFO] Loading test dataset from ../bert_data/cnndm.test.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 11:53:37,181 INFO] * number of parameters: 113041921
[2020-04-13 11:56:12,871 INFO] Loading test dataset from ../bert_data/cnndm.test.1.bert.pt, number of examples: 2001
[2020-04-13 11:58:54,699 INFO] Loading test dataset from ../bert_data/cnndm.test.2.bert.pt, number of examples: 2001
[2020-04-13 12:01:32,179 INFO] Loading test dataset from ../bert_data/cnndm.test.3.bert.pt, number of examples: 2001
[2020-04-13 12:04:09,930 INFO] Loading test dataset from ../bert_data/cnndm.test.4.bert.pt, number of examples: 2000
[2020-04-13 12:06:49,234 INFO] Loading test dataset from ../bert_data/cnndm.test.5.bert.pt, number of examples: 1485
11489
11489
2020-04-13 12:08:48,594 [MainThread  ] [INFO ]  Writing summaries.
[2020-04-13 12:08:48,594 INFO] Writing summaries.
2020-04-13 12:08:48,595 [MainThread  ] [INFO ]  Processing summaries. Saving system files to ../temp/tmplwbtcey1/system and model files to ../temp/tmplwbtcey1/model.
[2020-04-13 12:08:48,595 INFO] Processing summaries. Saving system files to ../temp/tmplwbtcey1/system and model files to ../temp/tmplwbtcey1/model.
2020-04-13 12:08:48,595 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-13-12-08-47/candidate/.
[2020-04-13 12:08:48,595 INFO] Processing files in ../temp/rouge-tmp-2020-04-13-12-08-47/candidate/.
2020-04-13 12:08:49,373 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmplwbtcey1/system.
[2020-04-13 12:08:49,373 INFO] Saved processed files to ../temp/tmplwbtcey1/system.
2020-04-13 12:08:49,374 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-13-12-08-47/reference/.
[2020-04-13 12:08:49,374 INFO] Processing files in ../temp/rouge-tmp-2020-04-13-12-08-47/reference/.
2020-04-13 12:08:50,166 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmplwbtcey1/model.
[2020-04-13 12:08:50,166 INFO] Saved processed files to ../temp/tmplwbtcey1/model.
2020-04-13 12:08:50,230 [MainThread  ] [INFO ]  Written ROUGE configuration to ../temp/tmpnbfamblx/rouge_conf.xml
[2020-04-13 12:08:50,230 INFO] Written ROUGE configuration to ../temp/tmpnbfamblx/rouge_conf.xml
2020-04-13 12:08:50,231 [MainThread  ] [INFO ]  Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmpnbfamblx/rouge_conf.xml
[2020-04-13 12:08:50,231 INFO] Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmpnbfamblx/rouge_conf.xml
---------------------------------------------
1 ROUGE-1 Average_R: 0.52049 (95%-conf.int. 0.51764 - 0.52326)
1 ROUGE-1 Average_P: 0.37017 (95%-conf.int. 0.36789 - 0.37252)
1 ROUGE-1 Average_F: 0.41820 (95%-conf.int. 0.41596 - 0.42030)
---------------------------------------------
1 ROUGE-2 Average_R: 0.23802 (95%-conf.int. 0.23536 - 0.24072)
1 ROUGE-2 Average_P: 0.16964 (95%-conf.int. 0.16756 - 0.17176)
1 ROUGE-2 Average_F: 0.19122 (95%-conf.int. 0.18905 - 0.19341)
---------------------------------------------
1 ROUGE-L Average_R: 0.47631 (95%-conf.int. 0.47356 - 0.47906)
1 ROUGE-L Average_P: 0.33932 (95%-conf.int. 0.33704 - 0.34160)
1 ROUGE-L Average_F: 0.38307 (95%-conf.int. 0.38093 - 0.38519)

[2020-04-13 12:10:18,797 INFO] Rouges at step 10000 
>> ROUGE-F(1/2/3/l): 41.82/19.12/38.31
ROUGE-R(1/2/3/l): 52.05/23.80/47.63

[2020-04-13 12:10:18,797 INFO] Validation xent: 5.65372 at step 10000
[2020-04-13 12:10:18,801 INFO] Loading checkpoint from ../models/bert_rnn/model_step_7000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 12:10:20,520 INFO] Loading test dataset from ../bert_data/cnndm.test.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 12:10:20,522 INFO] * number of parameters: 113041921
[2020-04-13 12:11:50,465 INFO] Loading test dataset from ../bert_data/cnndm.test.1.bert.pt, number of examples: 2001
^[[A[2020-04-13 12:14:16,131 INFO] Loading test dataset from ../bert_data/cnndm.test.2.bert.pt, number of examples: 2001
[2020-04-13 12:17:03,148 INFO] Loading test dataset from ../bert_data/cnndm.test.3.bert.pt, number of examples: 2001
[2020-04-13 12:19:52,680 INFO] Loading test dataset from ../bert_data/cnndm.test.4.bert.pt, number of examples: 2000
[2020-04-13 12:22:35,480 INFO] Loading test dataset from ../bert_data/cnndm.test.5.bert.pt, number of examples: 1485
11489
11489
2020-04-13 12:24:37,694 [MainThread  ] [INFO ]  Writing summaries.
[2020-04-13 12:24:37,694 INFO] Writing summaries.
2020-04-13 12:24:37,694 [MainThread  ] [INFO ]  Processing summaries. Saving system files to ../temp/tmpmmnqtap_/system and model files to ../temp/tmpmmnqtap_/model.
[2020-04-13 12:24:37,694 INFO] Processing summaries. Saving system files to ../temp/tmpmmnqtap_/system and model files to ../temp/tmpmmnqtap_/model.
2020-04-13 12:24:37,694 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-13-12-24-37/candidate/.
[2020-04-13 12:24:37,694 INFO] Processing files in ../temp/rouge-tmp-2020-04-13-12-24-37/candidate/.
2020-04-13 12:24:38,491 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmpmmnqtap_/system.
[2020-04-13 12:24:38,491 INFO] Saved processed files to ../temp/tmpmmnqtap_/system.
2020-04-13 12:24:38,491 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-13-12-24-37/reference/.
[2020-04-13 12:24:38,491 INFO] Processing files in ../temp/rouge-tmp-2020-04-13-12-24-37/reference/.
2020-04-13 12:24:39,284 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmpmmnqtap_/model.
[2020-04-13 12:24:39,284 INFO] Saved processed files to ../temp/tmpmmnqtap_/model.
2020-04-13 12:24:39,364 [MainThread  ] [INFO ]  Written ROUGE configuration to ../temp/tmpqpht3xku/rouge_conf.xml
[2020-04-13 12:24:39,364 INFO] Written ROUGE configuration to ../temp/tmpqpht3xku/rouge_conf.xml
2020-04-13 12:24:39,365 [MainThread  ] [INFO ]  Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmpqpht3xku/rouge_conf.xml
[2020-04-13 12:24:39,365 INFO] Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmpqpht3xku/rouge_conf.xml
---------------------------------------------
1 ROUGE-1 Average_R: 0.53304 (95%-conf.int. 0.53027 - 0.53573)
1 ROUGE-1 Average_P: 0.36036 (95%-conf.int. 0.35801 - 0.36288)
1 ROUGE-1 Average_F: 0.41577 (95%-conf.int. 0.41358 - 0.41784)
---------------------------------------------
1 ROUGE-2 Average_R: 0.24203 (95%-conf.int. 0.23950 - 0.24469)
1 ROUGE-2 Average_P: 0.16403 (95%-conf.int. 0.16199 - 0.16606)
1 ROUGE-2 Average_F: 0.18879 (95%-conf.int. 0.18674 - 0.19089)
---------------------------------------------
1 ROUGE-L Average_R: 0.48621 (95%-conf.int. 0.48355 - 0.48898)
1 ROUGE-L Average_P: 0.32934 (95%-conf.int. 0.32704 - 0.33168)
1 ROUGE-L Average_F: 0.37968 (95%-conf.int. 0.37744 - 0.38179)

[2020-04-13 12:26:12,607 INFO] Rouges at step 7000 
>> ROUGE-F(1/2/3/l): 41.58/18.88/37.97
ROUGE-R(1/2/3/l): 53.30/24.20/48.62

[2020-04-13 12:26:12,607 INFO] Validation xent: 5.68988 at step 7000
[2020-04-13 12:26:12,611 INFO] Loading checkpoint from ../models/bert_rnn/model_step_6000.pt
Namespace(accum_count=1, batch_size=30000, bert_config_path='../bert_config_uncased_base.json', bert_data_path='../bert_data/cnndm', beta1=0.9, beta2=0.999, block_trigram=True, dataset='', decay_method='', dropout=0.1, encoder='rnn', ff_size=512, gpu_ranks=[0], heads=4, hidden_size=128, inter_layers=2, log_file='../logs/bert_rnn_test', lr=1, max_grad_norm=0, mode='validate', model_path='../models/bert_rnn/', optim='adam', param_init=0, param_init_glorot=True, recall_eval=False, report_every=1, report_rouge=True, result_path='../results/result_rnn', rnn_size=768, save_checkpoint_steps=5, seed=666, temp_dir='../temp', test_all=True, test_from='', train_from='', train_steps=1000, use_interval=True, visible_gpus='0', warmup_steps=8000, world_size=1)
[2020-04-13 12:26:15,299 INFO] Loading test dataset from ../bert_data/cnndm.test.0.bert.pt, number of examples: 2001
gpu_rank 0
[2020-04-13 12:26:15,301 INFO] * number of parameters: 113041921
[2020-04-13 12:27:46,515 INFO] Loading test dataset from ../bert_data/cnndm.test.1.bert.pt, number of examples: 2001
[2020-04-13 12:30:15,901 INFO] Loading test dataset from ../bert_data/cnndm.test.2.bert.pt, number of examples: 2001
[2020-04-13 12:32:50,329 INFO] Loading test dataset from ../bert_data/cnndm.test.3.bert.pt, number of examples: 2001
[2020-04-13 12:35:29,731 INFO] Loading test dataset from ../bert_data/cnndm.test.4.bert.pt, number of examples: 2000
[2020-04-13 12:38:08,581 INFO] Loading test dataset from ../bert_data/cnndm.test.5.bert.pt, number of examples: 1485
11489
11489
2020-04-13 12:40:13,091 [MainThread  ] [INFO ]  Writing summaries.
[2020-04-13 12:40:13,091 INFO] Writing summaries.
2020-04-13 12:40:13,091 [MainThread  ] [INFO ]  Processing summaries. Saving system files to ../temp/tmp2_qs5b55/system and model files to ../temp/tmp2_qs5b55/model.
[2020-04-13 12:40:13,091 INFO] Processing summaries. Saving system files to ../temp/tmp2_qs5b55/system and model files to ../temp/tmp2_qs5b55/model.
2020-04-13 12:40:13,091 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-13-12-40-12/candidate/.
[2020-04-13 12:40:13,091 INFO] Processing files in ../temp/rouge-tmp-2020-04-13-12-40-12/candidate/.
2020-04-13 12:40:13,982 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmp2_qs5b55/system.
[2020-04-13 12:40:13,982 INFO] Saved processed files to ../temp/tmp2_qs5b55/system.
2020-04-13 12:40:13,982 [MainThread  ] [INFO ]  Processing files in ../temp/rouge-tmp-2020-04-13-12-40-12/reference/.
[2020-04-13 12:40:13,982 INFO] Processing files in ../temp/rouge-tmp-2020-04-13-12-40-12/reference/.
2020-04-13 12:40:14,850 [MainThread  ] [INFO ]  Saved processed files to ../temp/tmp2_qs5b55/model.
[2020-04-13 12:40:14,850 INFO] Saved processed files to ../temp/tmp2_qs5b55/model.
2020-04-13 12:40:14,941 [MainThread  ] [INFO ]  Written ROUGE configuration to ../temp/tmp3scqkb2h/rouge_conf.xml
[2020-04-13 12:40:14,941 INFO] Written ROUGE configuration to ../temp/tmp3scqkb2h/rouge_conf.xml
2020-04-13 12:40:14,941 [MainThread  ] [INFO ]  Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmp3scqkb2h/rouge_conf.xml
[2020-04-13 12:40:14,941 INFO] Running ROUGE with command /home/shad3/rouge/tools/ROUGE-1.5.5/ROUGE-1.5.5.pl -e /home/shad3/rouge/tools/ROUGE-1.5.5/data -c 95 -m -r 1000 -n 2 -a ../temp/tmp3scqkb2h/rouge_conf.xml
---------------------------------------------
1 ROUGE-1 Average_R: 0.53640 (95%-conf.int. 0.53376 - 0.53922)
1 ROUGE-1 Average_P: 0.36118 (95%-conf.int. 0.35900 - 0.36351)
1 ROUGE-1 Average_F: 0.41771 (95%-conf.int. 0.41556 - 0.41980)
---------------------------------------------
1 ROUGE-2 Average_R: 0.24390 (95%-conf.int. 0.24137 - 0.24659)
1 ROUGE-2 Average_P: 0.16426 (95%-conf.int. 0.16234 - 0.16629)
1 ROUGE-2 Average_F: 0.18974 (95%-conf.int. 0.18772 - 0.19185)
---------------------------------------------
1 ROUGE-L Average_R: 0.48940 (95%-conf.int. 0.48682 - 0.49216)
1 ROUGE-L Average_P: 0.33008 (95%-conf.int. 0.32789 - 0.33238)
1 ROUGE-L Average_F: 0.38149 (95%-conf.int. 0.37944 - 0.38357)

[2020-04-13 12:41:47,101 INFO] Rouges at step 6000 
>> ROUGE-F(1/2/3/l): 41.77/18.97/38.15
ROUGE-R(1/2/3/l): 53.64/24.39/48.94


